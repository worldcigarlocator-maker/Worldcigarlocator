<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <title>Min sida</title>
</head>
<body>
  <!-- Sidomenyn -->
  <ul id="sidebarMenu"></ul>

  <!-- Supabase och script -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    // ðŸ”§ Byt ut dessa mot dina egna vÃ¤rden frÃ¥n Supabase Project Settings
    const SUPABASE_URL = "https://gbxxoeplkzbhsvagnfsr.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdieHhvZXBsa3piaHN2YWduZnNyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc2NjQ1MDAsImV4cCI6MjA3MzI0MDUwMH0.E4Vk-GyLe22vyyfRy05hZtf4t5w_Bd_B-tkEFZ1alT4";

    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    async function buildSidebar() {
      const sidebar = document.getElementById("sidebarMenu");
      sidebar.innerHTML = "";

      // HÃ¤mta kontinenter
      const { data: continents, error: err1 } = await supabase
        .from("continents")
        .select("id, name")
        .order("name");

      if (err1) {
        console.error("Fel nÃ¤r kontinenter hÃ¤mtades:", err1);
        return;
      }

      // HÃ¤mta lÃ¤nder
      const { data: countries, error: err2 } = await supabase
        .from("countries")
        .select("id, name, flag, continent_id")
        .order("name");

      if (err2) {
        console.error("Fel nÃ¤r lÃ¤nder hÃ¤mtades:", err2);
        return;
      }

      // Bygg menyn
      continents.forEach(cont => {
        const contLi = document.createElement("li");
        contLi.textContent = cont.name;

        const countryUl = document.createElement("ul");

        countries
          .filter(c => c.continent_id === cont.id)
          .forEach(c => {
            const countryLi = document.createElement("li");
            countryLi.textContent = `${c.flag || ""} ${c.name}`;
            countryUl.appendChild(countryLi);
          });

        contLi.appendChild(countryUl);
        sidebar.appendChild(contLi);
      });
    }

    document.addEventListener("DOMContentLoaded", buildSidebar);
  </script>
</body>
</html>
